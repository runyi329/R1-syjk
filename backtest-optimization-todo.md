# 网格交易回测优化任务

## 核心问题
1. ❌ 7天回测耗时过长（用户等待时间不可接受）
2. ❌ 回测完成后结果丢失（前端状态丢失或后端超时）
3. ❌ 进度条不够直观（只显示百分比，看不出具体进度）

## 解决方案

### 第一阶段：实时进度显示（在策略图表区域）
- [ ] 移除模拟进度条逻辑
- [ ] 在策略图表区域显示实时回测进度
  - [ ] 显示当前回测日期（例如："正在回测：2024-01-15"）
  - [ ] 显示已完成天数/总天数（例如："3/7 天"）
  - [ ] 显示当前盈亏状态（实时更新）
- [ ] 使用轮询机制获取后端进度
  - [ ] 后端保存回测进度到内存或数据库
  - [ ] 前端每秒查询一次进度
  - [ ] 回测完成后自动跳转到结果页面

### 第二阶段：优化数据库查询性能
- [ ] 分析当前按天查询的性能瓶颈
- [ ] 优化查询策略
  - [ ] 方案A：批量查询（一次查询所有数据，前端分批处理）
  - [ ] 方案B：增加数据库索引
  - [ ] 方案C：使用数据库连接池
- [ ] 测试优化后的查询速度

### 第三阶段：增强回测结果展示
- [ ] 添加盈亏曲线图表（使用 recharts）
- [ ] 添加交易记录列表（显示前100条买卖详情）
- [ ] 添加价格走势图（K线图或折线图）
- [ ] 优化结果页面布局（多维度展示）
- [ ] 添加结果导出功能（PDF或图片）

### 第四阶段：结果持久化
- [ ] 创建回测结果表（backtest_results）
- [ ] 保存回测参数和结果到数据库
- [ ] 添加历史回测记录查看功能
- [ ] 支持对比不同参数的回测结果

## 优先级
1. 🔥 高优先级：实时进度显示（解决用户体验问题）
2. 🔥 高优先级：查询性能优化（解决速度问题）
3. 🔶 中优先级：结果展示增强（提升价值）
4. 🔵 低优先级：结果持久化（扩展功能）
